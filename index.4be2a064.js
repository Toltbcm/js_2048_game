var t={};class e{static GAME_SIZE=4;constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.status="idle",this.score=0,this.state=t,this.initialState=JSON.parse(JSON.stringify(t)),this.moveLeft=this.wrapMove(this.moveLeft),this.moveRight=this.wrapMove(this.moveRight),this.moveUp=this.wrapMove(this.moveUp),this.moveDown=this.wrapMove(this.moveDown)}wrapMove(t){return(function(){if("playing"!==this.status)return;let e=JSON.stringify(this.state);t.apply(this),this.has2048()||(JSON.stringify(this.state)!==e&&this.addCellToState(),this.hasMove())}).bind(this)}moveLeft(){for(let t=0;t<e.GAME_SIZE;t++){let s=[],i=!0;for(let a=0;a<e.GAME_SIZE;a++)if(0!==this.state[t][a]){if(0===a||!i||this.state[t][a]!==s[s.length-1]){s.push(this.state[t][a]),i=!0;continue}s[s.length-1]+=this.state[t][a],this.score+=s[s.length-1],i=!1}for(;s.length<e.GAME_SIZE;)s.push(0);this.state[t]=s}}moveRight(){let t=e.GAME_SIZE-1;for(let s=t;s>=0;s--){let i=[],a=!0;for(let e=t;e>=0;e--)if(0!==this.state[s][e]){if(e===t||!a||this.state[s][e]!==i[0]){i.unshift(this.state[s][e]),a=!0;continue}i[0]+=this.state[s][e],this.score+=i[0],a=!1}for(;i.length<e.GAME_SIZE;)i.unshift(0);this.state[s]=i}}moveUp(){for(let t=0;t<e.GAME_SIZE;t++){let s=[],i=!0;for(let a=0;a<e.GAME_SIZE;a++)if(0!==this.state[a][t]){if(0===a||!i||this.state[a][t]!==s[s.length-1]){s.push(this.state[a][t]),i=!0;continue}s[s.length-1]+=this.state[a][t],this.score+=s[s.length-1],i=!1}for(let i=0;i<e.GAME_SIZE;i++)this.state[i][t]=s[i]?s[i]:0}}moveDown(){let t=e.GAME_SIZE-1;for(let s=t;s>=0;s--){let i=[],a=!0;for(let e=t;e>=0;e--)if(0!==this.state[e][s]){if(e===t||!a||this.state[e][s]!==i[0]){i.unshift(this.state[e][s]),a=!0;continue}i[0]+=this.state[e][s],this.score+=i[0],a=!1}for(let a=t;a>=0;a--){let t=a-(e.GAME_SIZE-i.length);this.state[a][s]=i[t]?i[t]:0}}}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.initializeState(),this.status="playing"}restart(){this.status="idle",this.score=0,this.state=JSON.parse(JSON.stringify(this.initialState))}getRandomPosition(){return Math.floor(Math.random()*e.GAME_SIZE)}getRandomValue(){return 9>Math.floor(10*Math.random())?2:4}addCellToState(){let t,e;if(this.hasEmptyCell()){do t=this.getRandomPosition(),e=this.getRandomPosition();while(0!==this.state[e][t])this.state[e][t]=this.getRandomValue()}}initializeState(){this.addCellToState(),this.addCellToState()}hasEmptyCell(){for(let t=0;t<e.GAME_SIZE;t++)if(this.state[t].includes(0))return!0;return!1}has2048(){for(let t=0;t<e.GAME_SIZE;t++)if(this.state[t].includes(2048))return this.status="win",!0;return!1}hasMove(){let t=e.GAME_SIZE-1;for(let s=0;s<e.GAME_SIZE;s++){if(this.state[s].includes(0))return!0;for(let i=0;i<e.GAME_SIZE;i++)if(i!==t&&this.state[s][i]===this.state[s][i+1]||s!==t&&this.state[s][i]===this.state[s+1][i])return!0}return this.status="lose",!1}}const s=new(t=e),i=document.querySelector(".game-field"),a=document.querySelector(".button.start"),o=document.querySelector(".message-start"),r=document.querySelector(".message-win"),n=document.querySelector(".message-lose"),h=document.querySelector(".game-score");function l(){for(let e=0;e<t.GAME_SIZE;e++)for(let a=0;a<t.GAME_SIZE;a++){if(0===s.getState()[e][a]){i.rows[e].cells[a].className="field-cell",i.rows[e].cells[a].textContent="";continue}i.rows[e].cells[a].className=`field-cell field-cell--${s.getState()[e][a]}`,i.rows[e].cells[a].textContent=s.getState()[e][a]}h.textContent=s.getScore()}l(),a.addEventListener("click",()=>{a.classList.contains("start")?(a.className="button restart",a.textContent="Restart",s.start(),l(),o.classList.add("hidden")):(a.className="button start",a.textContent="Start",s.restart(),l(),o.classList.remove("hidden"),r.classList.add("hidden"),n.classList.add("hidden"))}),document.body.addEventListener("keydown",function t(e){switch(e.code){case"ArrowUp":s.moveUp();break;case"ArrowDown":s.moveDown();break;case"ArrowLeft":s.moveLeft();break;case"ArrowRight":s.moveRight()}l(),"win"===s.getStatus()?(r.classList.remove("hidden"),document.body.removeEventListener("keydown",t)):"lose"===s.getStatus()&&(n.classList.remove("hidden"),document.body.removeEventListener("keydown",t))});
//# sourceMappingURL=index.4be2a064.js.map

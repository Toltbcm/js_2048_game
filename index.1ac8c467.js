!function(){var t,e={},s=function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.status="idle",this.score=0,this.state=t,this.initialState=JSON.parse(JSON.stringify(t)),this.moveLeft=this.wrapMove(this.moveLeft),this.moveRight=this.wrapMove(this.moveRight),this.moveUp=this.wrapMove(this.moveUp),this.moveDown=this.wrapMove(this.moveDown)}return t=[{key:"wrapMove",value:function(t){return(function(){if("playing"===this.status){var e=JSON.stringify(this.state);t.apply(this),this.has2048()||(JSON.stringify(this.state)!==e&&this.addCellToState(),this.hasMove())}}).bind(this)}},{key:"moveLeft",value:function(){for(var t=0;t<e.GAME_SIZE;t++){for(var s=[],i=!0,a=0;a<e.GAME_SIZE;a++)if(0!==this.state[t][a]){if(0===a||!i||this.state[t][a]!==s[s.length-1]){s.push(this.state[t][a]),i=!0;continue}s[s.length-1]+=this.state[t][a],this.score+=s[s.length-1],i=!1}for(;s.length<e.GAME_SIZE;)s.push(0);this.state[t]=s}}},{key:"moveRight",value:function(){for(var t=e.GAME_SIZE-1,s=t;s>=0;s--){for(var i=[],a=!0,n=t;n>=0;n--)if(0!==this.state[s][n]){if(n===t||!a||this.state[s][n]!==i[0]){i.unshift(this.state[s][n]),a=!0;continue}i[0]+=this.state[s][n],this.score+=i[0],a=!1}for(;i.length<e.GAME_SIZE;)i.unshift(0);this.state[s]=i}}},{key:"moveUp",value:function(){for(var t=0;t<e.GAME_SIZE;t++){for(var s=[],i=!0,a=0;a<e.GAME_SIZE;a++)if(0!==this.state[a][t]){if(0===a||!i||this.state[a][t]!==s[s.length-1]){s.push(this.state[a][t]),i=!0;continue}s[s.length-1]+=this.state[a][t],this.score+=s[s.length-1],i=!1}for(var n=0;n<e.GAME_SIZE;n++)this.state[n][t]=s[n]?s[n]:0}}},{key:"moveDown",value:function(){for(var t=e.GAME_SIZE-1,s=t;s>=0;s--){for(var i=[],a=!0,n=t;n>=0;n--)if(0!==this.state[n][s]){if(n===t||!a||this.state[n][s]!==i[0]){i.unshift(this.state[n][s]),a=!0;continue}i[0]+=this.state[n][s],this.score+=i[0],a=!1}for(var o=t;o>=0;o--){var r=o-(e.GAME_SIZE-i.length);this.state[o][s]=i[r]?i[r]:0}}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.initializeState(),this.status="playing"}},{key:"restart",value:function(){this.status="idle",this.score=0,this.state=JSON.parse(JSON.stringify(this.initialState))}},{key:"getRandomPosition",value:function(){return Math.floor(Math.random()*e.GAME_SIZE)}},{key:"getRandomValue",value:function(){return 9>Math.floor(10*Math.random())?2:4}},{key:"addCellToState",value:function(){var t,e;if(this.hasEmptyCell()){do t=this.getRandomPosition(),e=this.getRandomPosition();while(0!==this.state[e][t])this.state[e][t]=this.getRandomValue()}}},{key:"initializeState",value:function(){this.addCellToState(),this.addCellToState()}},{key:"hasEmptyCell",value:function(){for(var t=0;t<e.GAME_SIZE;t++)if(this.state[t].includes(0))return!0;return!1}},{key:"has2048",value:function(){for(var t=0;t<e.GAME_SIZE;t++)if(this.state[t].includes(2048))return this.status="win",!0;return!1}},{key:"hasMove",value:function(){for(var t=e.GAME_SIZE-1,s=0;s<e.GAME_SIZE;s++){if(this.state[s].includes(0))return!0;for(var i=0;i<e.GAME_SIZE;i++)if(i!==t&&this.state[s][i]===this.state[s][i+1]||s!==t&&this.state[s][i]===this.state[s+1][i])return!0}return this.status="lose",!1}}],function(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(e.prototype,t),e}();(t="GAME_SIZE")in s?Object.defineProperty(s,t,{value:4,enumerable:!0,configurable:!0,writable:!0}):s[t]=4;var i=new(e=s),a=document.querySelector(".game-field"),n=document.querySelector(".button.start"),o=document.querySelector(".message-start"),r=document.querySelector(".message-win"),h=document.querySelector(".message-lose"),u=document.querySelector(".game-score");function l(){for(var t=0;t<e.GAME_SIZE;t++)for(var s=0;s<e.GAME_SIZE;s++){if(0===i.getState()[t][s]){a.rows[t].cells[s].className="field-cell",a.rows[t].cells[s].textContent="";continue}a.rows[t].cells[s].className="field-cell field-cell--".concat(i.getState()[t][s]),a.rows[t].cells[s].textContent=i.getState()[t][s]}u.textContent=i.getScore()}l(),n.addEventListener("click",function(){n.classList.contains("start")?(n.className="button restart",n.textContent="Restart",i.start(),l(),o.classList.add("hidden")):(n.className="button start",n.textContent="Start",i.restart(),l(),o.classList.remove("hidden"),r.classList.add("hidden"),h.classList.add("hidden"))}),document.body.addEventListener("keydown",function t(e){switch(e.code){case"ArrowUp":i.moveUp();break;case"ArrowDown":i.moveDown();break;case"ArrowLeft":i.moveLeft();break;case"ArrowRight":i.moveRight()}l(),"win"===i.getStatus()?(r.classList.remove("hidden"),document.body.removeEventListener("keydown",t)):"lose"===i.getStatus()&&(h.classList.remove("hidden"),document.body.removeEventListener("keydown",t))})}();
//# sourceMappingURL=index.1ac8c467.js.map
